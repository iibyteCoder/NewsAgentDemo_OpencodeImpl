# 新闻资讯收集智能体 - 使用指南

## 📋 配置完成

你的智能体已经配置完成！以下是创建的文件：

```
OpencodeTest_1/
├── opencode.json              # 主配置文件
├── prompts/
│   └── news-collector.txt     # 主Agent提示词
└── .opencode/
    └── agents/                # Subagent配置（自动调用）
        ├── event-aggregator.md
        ├── validator.md
        ├── timeline-builder.md
        ├── predictor.md
        └── synthesizer.md
```

---

## 🚀 使用方法

### 1. 启动 OpenCode

在项目根目录启动 OpenCode：
```bash
cd d:\myprojects\PythonProjects\LearningProjects\OpencodeTest_1
opencode
```

### 2. 切换到 news-collector Agent

按 **Tab** 键切换到 `news-collector` agent

### 3. 输入需求

直接用自然语言描述你的需求：

```
帮我收集体育运动和国际政治相关新闻
```

或者：

```
我最近在学习人工智能相关知识，请帮我收集相关资讯
```

或者：

```
收集美国大选和国际金价相关新闻
```

### 4. 等待完成

系统会自动完成以下步骤：
1. ✅ 搜索多个新闻源
2. ✅ 获取新闻内容
3. ✅ 聚合为事件
4. ✅ 验证真实性
5. ✅ 构建时间轴
6. ✅ 预测趋势
7. ✅ 生成报告

**预计时间**: 10-20分钟（取决于新闻数量）

### 5. 查看报告

完成后会在项目根目录生成：
```
report_20260128_153045/
├── 体育运动/
│   ├── 2026-01-28/
│   │   ├── 冬奥会中国代表团成立.md
│   │   │   ├── 摘要
│   │   │   ├── 来源（3个URL）
│   │   │   ├── 真实性验证（85分）
│   │   │   ├── 事件时间轴
│   │   │   └── 趋势预测
│   │   ├── 资讯汇总与摘要.md
│   │   └── index.md
│   └── index.md
├── 国际政治/
│   └── ...
└── index.md
```

---

## 🔧 工作原理

### 六阶段流程

```
用户输入
    ↓
┌─────────────────────────────────┐
│ 阶段1: 收集                      │
│  - 并行搜索各类型新闻            │
│  - 获取完整内容                  │
└─────────────┬───────────────────┘
              ↓
┌─────────────────────────────────┐
│ 阶段2: 聚合 ⭐                   │
│  - 调用 event-aggregator         │
│  - 多个URL → 事件                │
└─────────────┬───────────────────┘
              ↓
┌─────────────────────────────────┐
│ 阶段3-5: 深度分析 ⭐             │
│  - 对每个事件并行调用：          │
│    · validator (验证真实性)      │
│    · timeline-builder (时间轴)   │
│    · predictor (预测)            │
└─────────────┬───────────────────┘
              ↓
┌─────────────────────────────────┐
│ 阶段6: 报告生成                  │
│  - 调用 synthesizer              │
│  - 生成结构化报告                │
└─────────────────────────────────┘
```

### Subagent自动调用

主Agent会自动调用以下subagent：

| Subagent | 作用 | 何时调用 |
|----------|------|----------|
| event-aggregator | 聚合URL为事件 | 阶段2 |
| validator | 验证真实性 | 阶段3（并行） |
| timeline-builder | 构建时间轴 | 阶段4（并行） |
| predictor | 趋势预测 | 阶段5（并行） |
| synthesizer | 生成报告 | 阶段6 |

---

## 📊 支持的需求等级

### ✅ C级：基础收集
```
"帮我收集体育运动类资讯"
```

### ✅ B级：多类型并行
```
"帮我收集体育运动和国际政治相关新闻"
```

### ✅ A级：智能理解
```
"我最近在学习人工智能相关知识，请帮我收集相关资讯"
```

### ✅ S级：深度分析
```
"收集美国大选相关新闻"
→ 包含：时间轴 + 趋势预测
```

---

## 🎯 核心特性

- **一键式**: 只需输入需求，无需其他操作
- **智能聚合**: 自动识别同一事件的多个报道
- **真实性验证**: 多轮搜索验证，给出可信度评分
- **时间轴构建**: 主动填补缺口，还原完整脉络
- **趋势预测**: 基于历史和专家观点的多情景预测
- **并行处理**: 多个事件同时分析，提高效率

---

## 🛠️ 故障排查

### Agent未显示
```bash
# 检查配置文件
opencode agent list

# 应该看到：
# - news-collector (primary)
# - event-aggregator (subagent, hidden)
# - validator (subagent, hidden)
# - timeline-builder (subagent, hidden)
# - predictor (subagent, hidden)
# - synthesizer (subagent, hidden)
```

### Subagent调用失败
检查 `opencode.json` 中的 `permission.task` 是否设置为 `"*": "allow"`

### 报告未生成
检查 `news-collector.txt` 提示词文件路径是否正确

---

## 📝 示例对话

```
You: 帮我收集体育运动和国际政治相关新闻

OpenCode: [自动执行]
  搜索体育运动新闻... ✅
  搜索国际政治新闻... ✅
  获取20条新闻内容... ✅
  聚合为6个事件... ✅

  [并行分析6个事件]
  事件1: 验证 ✅ 时间轴 ✅ 预测 ✅
  事件2: 验证 ✅ 时间轴 ✅ 预测 ✅
  ...

  生成报告... ✅

  ✓ 报告已生成: report_20260128_153045/
  ✓ 共收集6个事件
  ✓ 包含体育类3个，政治类3个
  ✓ 总耗时15分钟
```

---

## 🎉 开始使用

现在就可以开始使用了！在 OpenCode 中输入你的需求即可。

如果需要调整配置，可以编辑：
- `opencode.json` - 主配置
- `prompts/news-collector.txt` - 主Agent提示词
- `.opencode/agents/*.md` - Subagent配置
