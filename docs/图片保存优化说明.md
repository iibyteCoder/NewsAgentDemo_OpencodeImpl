# å›¾ç‰‡ä¿å­˜åŠŸèƒ½ä¼˜åŒ–è¯´æ˜

## ğŸ“‹ ä¼˜åŒ–æ¦‚è¿°

æœ¬æ¬¡ä¼˜åŒ–å®Œå–„äº†æ–°é—»æ”¶é›†ç³»ç»Ÿçš„å›¾ç‰‡ä¿å­˜åŠŸèƒ½ï¼Œç¡®ä¿ä»å›¾ç‰‡æå–åˆ°æœ¬åœ°å­˜å‚¨çš„å®Œæ•´æµç¨‹ã€‚

## âœ… å·²å®Œæˆçš„ä¼˜åŒ–

### 1. MCP æœåŠ¡å™¨å±‚é¢

#### **news_storage/main.py**
- âœ… åœ¨ `news_storage_save` å·¥å…·ä¸­æ·»åŠ äº† `local_images` å‚æ•°
- âœ… æ”¯æŒä¿å­˜ä¸‹è½½åçš„æœ¬åœ°å›¾ç‰‡è·¯å¾„
- âœ… å‚æ•°è¯´æ˜åŒ…å«ä½¿ç”¨ç¤ºä¾‹

**å…³é”®ä»£ç **ï¼š
```python
async def save_news(
    title: str,
    url: str,
    ...
    images: str = "[]",        # è¿œç¨‹å›¾ç‰‡URL
    local_images: str = "[]",  # æœ¬åœ°å›¾ç‰‡è·¯å¾„ï¼ˆæ–°å¢ï¼‰
    ...
) -> str:
```

### 2. æ™ºèƒ½ä½“æç¤ºè¯å±‚é¢

#### **prompts/news-collector.txt** (ä¸»æ™ºèƒ½ä½“)
- âœ… æ›´æ–°æ•°æ®å­˜å‚¨å·¥å…·è¯´æ˜ï¼Œæ˜ç¡® `images` å’Œ `local_images` çš„åŒºåˆ«
- âœ… æ–°å¢"å›¾ç‰‡å¤„ç†è§„èŒƒ"ç« èŠ‚ï¼Œè¯´æ˜å®Œæ•´å·¥ä½œæµç¨‹
- âœ… æ·»åŠ å›¾ç‰‡ä¿å­˜ç»“æ„ç¤ºä¾‹

#### **.opencode/agents/synthesizer.md** (æŠ¥å‘Šç”Ÿæˆæ™ºèƒ½ä½“)
- âœ… æ·»åŠ  `news-storage_save_news_tool` æ›´æ–°æœ¬åœ°å›¾ç‰‡è·¯å¾„çš„è¯´æ˜
- âœ… ä¼˜åŒ–å›¾ç‰‡ä¸‹è½½æµç¨‹ï¼Œæ–°å¢"æ›´æ–°æ•°æ®åº“"æ­¥éª¤
- âœ… å®Œå–„å›¾ç‰‡ä¸‹è½½ç­–ç•¥ä»£ç ç¤ºä¾‹ï¼ŒåŒ…å«åŒ¹é…å’Œæ›´æ–°é€»è¾‘
- âœ… æ˜ç¡®å›¾ç‰‡å¼•ç”¨æ–¹å¼ï¼šä¼˜å…ˆä½¿ç”¨ `local_images`ï¼Œé™çº§ä½¿ç”¨ `images`

#### **.opencode/agents/validator.md** (éªŒè¯æ™ºèƒ½ä½“)
- âœ… æ›´æ–°æ•°æ®åº“å·¥å…·è¯´æ˜
- âœ… æ˜ç¡®éªŒè¯é˜¶æ®µåªä¿å­˜ `images`ï¼Œ`local_images` ç”± synthesizer å¡«å†™

#### **.opencode/agents/timeline-builder.md** (æ—¶é—´è½´æ„å»ºæ™ºèƒ½ä½“)
- âœ… æ›´æ–°æ•°æ®åº“å·¥å…·è¯´æ˜
- âœ… æ˜ç¡®æ—¶é—´è½´æ„å»ºé˜¶æ®µåªä¿å­˜ `images`

#### **.opencode/agents/predictor.md** (é¢„æµ‹æ™ºèƒ½ä½“)
- âœ… æ›´æ–°æ•°æ®åº“å·¥å…·è¯´æ˜
- âœ… æ˜ç¡®é¢„æµ‹é˜¶æ®µåªä¿å­˜ `images`

### 3. ç°æœ‰åŠŸèƒ½ç¡®è®¤

#### **web_browser/tools/search_tools.py**
- âœ… `fetch_article_content` å‡½æ•°å·²æ”¯æŒå›¾ç‰‡æå–ï¼ˆ`include_images=True`ï¼‰
- âœ… `_extract_images` å‡½æ•°ä¼šæå–å®Œæ•´çš„å›¾ç‰‡ä¿¡æ¯ï¼ˆURLã€altã€å°ºå¯¸ç­‰ï¼‰

#### **downloader/main.py**
- âœ… æä¾›æ‰¹é‡ä¸‹è½½åŠŸèƒ½ `downloader_download_files`
- âœ… è¿”å›è¯¦ç»†çš„ä¸‹è½½ç»“æœï¼ˆæˆåŠŸ/å¤±è´¥çŠ¶æ€ã€æœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼‰

## ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹

### é˜¶æ®µ1ï¼šæ”¶é›†é˜¶æ®µï¼ˆä¸»æ™ºèƒ½ä½“ + æœç´¢ï¼‰
```python
# 1. æœç´¢æ–°é—»
web-browser_multi_search_tool(query="AIæŠ€æœ¯çªç ´", num_results=20)

# 2. è·å–æ–‡ç« å†…å®¹ï¼ˆåŒ…å«å›¾ç‰‡URLï¼‰
web-browser_fetch_article_content_tool(url="...", include_images=True)

# 3. ä¿å­˜åˆ°æ•°æ®åº“ï¼ˆimageså­—æ®µåŒ…å«è¿œç¨‹URLï¼‰
news-storage_save_news_tool(
    title="AIæŠ€æœ¯çªç ´",
    url="https://...",
    images='["https://example.com/img1.jpg", "https://example.com/img2.jpg"]',
    local_images='[]'  # æ­¤æ—¶ä¸ºç©º
)
```

### é˜¶æ®µ2ï¼šéªŒè¯/åˆ†æé˜¶æ®µï¼ˆvalidator/timeline-builder/predictorï¼‰
```python
# æœç´¢è¡¥å……ä¿¡æ¯å¹¶ä¿å­˜
news-storage_save_news_tool(
    title="ç›¸å…³æŠ¥é“",
    url="https://...",
    images='["https://other.com/img3.jpg"]',  # åªä¿å­˜è¿œç¨‹URL
    local_images='[]'  # ä»ç„¶ä¸ºç©º
)
```

### é˜¶æ®µ3ï¼šæŠ¥å‘Šç”Ÿæˆé˜¶æ®µï¼ˆsynthesizerï¼‰
```python
# 1. ä»æ•°æ®åº“è¯»å–äº‹ä»¶çš„æ‰€æœ‰æ–°é—»
news-storage_search_news_tool(event_name="AIæŠ€æœ¯çªç ´", limit=100)

# 2. æå–æ‰€æœ‰å›¾ç‰‡URLå¹¶å»é‡
all_images = extract_and_deduplicate_images(news_list)

# 3. åˆ›å»ºç›®å½•å¹¶æ‰¹é‡ä¸‹è½½
mkdir -p "./report/ç§‘æŠ€/2026-01-29/èµ„è®¯æ±‡æ€»ä¸æ‘˜è¦/AIæŠ€æœ¯çªç ´/"
download_result = downloader_download_files(
    urls=all_images,
    save_path="./report/ç§‘æŠ€/2026-01-29/èµ„è®¯æ±‡æ€»ä¸æ‘˜è¦/AIæŠ€æœ¯çªç ´/"
)

# 4. åŒ¹é…æ¯æ¡æ–°é—»çš„å›¾ç‰‡å¹¶æ›´æ–°æ•°æ®åº“
for news in news_list:
    local_images = match_downloaded_images(news["images"], download_result)
    news-storage_save_news_tool(
        title=news["title"],
        url=news["url"],
        local_images=json.dumps(local_images)  # æ›´æ–°æœ¬åœ°è·¯å¾„
    )

# 5. ç”ŸæˆæŠ¥å‘Šï¼ˆä½¿ç”¨local_imageså­—æ®µï¼‰
![](./AIæŠ€æœ¯çªç ´/image1.jpg)
```

## ğŸ“ æœ€ç»ˆç›®å½•ç»“æ„

```
report/
â”œâ”€â”€ ç§‘æŠ€æ–°é—»/
â”‚   â””â”€â”€ 2026-01-29/
â”‚       â””â”€â”€ èµ„è®¯æ±‡æ€»ä¸æ‘˜è¦/
â”‚           â”œâ”€â”€ index.md
â”‚           â”œâ”€â”€ AIæŠ€æœ¯çªç ´.md
â”‚           â”œâ”€â”€ AIæŠ€æœ¯çªç ´/
â”‚           â”‚   â”œâ”€â”€ image1.jpg  â† å·²ä¸‹è½½
â”‚           â”‚   â””â”€â”€ image2.png  â† å·²ä¸‹è½½
â”‚           â”œâ”€â”€ å¦ä¸€ä¸ªäº‹ä»¶.md
â”‚           â””â”€â”€ å¦ä¸€ä¸ªäº‹ä»¶/
â”‚               â””â”€â”€ ...
â””â”€â”€ æ€»ç´¢å¼•.md
```

## ğŸ¯ å…³é”®æ”¹è¿›ç‚¹

1. **åˆ†ç¦»å…³æ³¨ç‚¹**ï¼š
   - `images`ï¼šè¿œç¨‹URLï¼ˆæ‰€æœ‰é˜¶æ®µï¼‰
   - `local_images`ï¼šæœ¬åœ°è·¯å¾„ï¼ˆä»…æŠ¥å‘Šé˜¶æ®µï¼‰

2. **æ•°æ®å®Œæ•´æ€§**ï¼š
   - æ‰€æœ‰é˜¶æ®µçš„å›¾ç‰‡URLéƒ½è¢«è®°å½•
   - æŠ¥å‘Šç”Ÿæˆæ—¶æ‰ä¸‹è½½åˆ°æœ¬åœ°
   - æ•°æ®åº“ä¿ç•™å®Œæ•´çš„å¯è¿½æº¯æ€§

3. **é™çº§ç­–ç•¥**ï¼š
   - ä¼˜å…ˆä½¿ç”¨æœ¬åœ°å›¾ç‰‡ï¼ˆ`local_images`ï¼‰
   - å¦‚æœä¸ºç©ºåˆ™ä½¿ç”¨è¿œç¨‹URLï¼ˆ`images`ï¼‰
   - åœ¨æŠ¥å‘Šä¸­æ ‡æ³¨å›¾ç‰‡æ¥æº

4. **çµæ´»æ€§**ï¼š
   - æ™ºèƒ½ä½“å¯é€‰æ‹©æ˜¯å¦ä¸‹è½½å›¾ç‰‡
   - æ”¯æŒæ‰¹é‡ä¸‹è½½å’Œå¹¶å‘
   - ä¸‹è½½å¤±è´¥ä¸å½±å“æ•´ä½“æµç¨‹

## ğŸ“ ä½¿ç”¨å»ºè®®

### å¯¹äºä¸»æ™ºèƒ½ä½“
1. æœç´¢æ–°é—»æ—¶ç¡®ä¿ `include_images=True`
2. ä¿å­˜æ—¶å¿…é¡»å¡«å†™ `images` å­—æ®µ
3. `local_images` ä¿æŒä¸ºç©ºå­—ç¬¦ä¸² `"[]"`

### å¯¹äºåˆ†ææ™ºèƒ½ä½“ï¼ˆvalidator/timeline-builder/predictorï¼‰
1. æœç´¢è¡¥å……ä¿¡æ¯æ—¶åŒæ ·æå–å›¾ç‰‡
2. åªä¿å­˜ `images` å­—æ®µ
3. ä¸éœ€è¦å…³å¿ƒå›¾ç‰‡ä¸‹è½½

### å¯¹äºæŠ¥å‘Šç”Ÿæˆæ™ºèƒ½ä½“ï¼ˆsynthesizerï¼‰
1. **å¿…é¡»**ä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ°
2. **å¿…é¡»**æ›´æ–°æ•°æ®åº“çš„ `local_images` å­—æ®µ
3. æŠ¥å‘Šä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨å›¾ç‰‡
4. æŒ‰äº‹ä»¶ç»„ç»‡å›¾ç‰‡æ–‡ä»¶å¤¹

## ğŸ” éªŒè¯æ¸…å•

- [x] MCPæœåŠ¡å™¨æ”¯æŒ `local_images` å‚æ•°
- [x] ä¸»æ™ºèƒ½ä½“æ˜ç¡®å›¾ç‰‡ä¿å­˜æµç¨‹
- [x] synthesizer æ™ºèƒ½ä½“æœ‰å®Œæ•´çš„ä¸‹è½½å’Œæ›´æ–°æµç¨‹
- [x] å…¶ä»–åˆ†ææ™ºèƒ½ä½“æ˜ç¡®åªä¿å­˜è¿œç¨‹URL
- [x] web-browser æ­£ç¡®æå–å›¾ç‰‡
- [x] downloader æ”¯æŒæ‰¹é‡ä¸‹è½½

## ğŸš€ åç»­å¯èƒ½çš„å¢å¼º

1. **å›¾ç‰‡å‹ç¼©**ï¼šä¸‹è½½æ—¶è‡ªåŠ¨å‹ç¼©å¤§å›¾ç‰‡
2. **æ ¼å¼è½¬æ¢**ï¼šç»Ÿä¸€è½¬æ¢ä¸º WebP ç­‰æ ¼å¼
3. **å»é‡ä¼˜åŒ–**ï¼šåŸºäºå›¾ç‰‡å†…å®¹å“ˆå¸Œå»é‡
4. **æ™ºèƒ½é‡è¯•**ï¼šä¸‹è½½å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•
5. **è¿›åº¦è¿½è¸ª**ï¼šæ˜¾ç¤ºä¸‹è½½è¿›åº¦å’ŒæˆåŠŸç‡

---

**ä¼˜åŒ–æ—¥æœŸ**ï¼š2026-01-29
**ä¼˜åŒ–èŒƒå›´**ï¼šMCPæœåŠ¡å™¨ + æ‰€æœ‰æ™ºèƒ½ä½“æç¤ºè¯
**çŠ¶æ€**ï¼šâœ… å·²å®Œæˆ
